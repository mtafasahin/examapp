@if(student) 
{
<mat-card class="profile-card">
  <mat-card-header>
    <div class="profile-header stats-container">
      <div class="avatar-container">
        <img [src]="student.avatarUrl || 'assets/default-avatar.png'" class="avatar" />
        <div class="avatar-overlay" (click)="avatarInput.click()">
          <span>Change</span>
        </div>
        <input type="file" #avatarInput (change)="onAvatarChange($event)" hidden />
      </div>
      <div class="stat">
        <h2>{{ student.fullName }}</h2>        
      </div>
      
      <div class="stat">
        <mat-select [(value)]="student.gradeId" (selectionChange)="changeGrade()">
            @for ( grade of grades ; track grade.id ) 
            {
              <mat-option [value]="grade.id">{{ grade.name }}</mat-option>
            }
          </mat-select>
      </div>
      <div class="stat"><p>Seviye: {{ student.level }} ({{ student.xp }} XP)</p></div>
      
    </div>
  </mat-card-header>
    <mat-card-content >
      
      <div class="stats-container">
        <div class="stat">
          <mat-icon>question_answer</mat-icon>
          <span>{{ student.totalQuestionsSolved }} Soru Çözüldü</span>
        </div>
        <div class="stat">
          <mat-icon>check_circle</mat-icon>
          <span>{{ student.correctAnswers }} Doğru Cevap</span>
        </div>
        <div class="stat">
          <mat-icon>highlight_off</mat-icon>
          <span>{{ student.wrongAnswers }} Yanlış Cevap</span>
        </div>
        <div class="stat">
          <mat-icon>assignment_turned_in</mat-icon>
          <span>{{ student.testsCompleted }} Tamamlanan Test</span>
        </div>
        <div class="stat">
          <mat-icon>emoji_events</mat-icon>
          <span>{{ student.totalRewards }} Kazanılan Ödül</span>
        </div>
        <div class="stat">
          <mat-icon>leaderboard</mat-icon>
          <span>Liderlik Sıralaması: {{ student.leaderboardRank || '-' }}</span>
        </div>
      </div>

      <h3>🎖 Kazanılan Rozetler</h3>
      <div class="badges-container">
        @for ( badge of student.badges ; track badge.name ) 
        {
          <img [src]="badge.imageUrl" [matTooltip]="badge.name" class="badge" />
        }
      </div>

      <h3>📌 Son Çözülen Testler</h3>
      <mat-list>
        @for (test of student.recentTests ; track test.name) 
        {
          <mat-list-item>
            <span>{{ test.name }}</span>
            <span class="test-score">{{ test.score }}/{{ test.totalQuestions * 10 }} Puan</span>
          </mat-list-item>
        }
       
      </mat-list>
    </mat-card-content>
  </mat-card>
}