<div class="program-detail-container">
  <h2 class="program-title">{{ program.programName }}</h2>
  <div class="program-meta">
    <span><mat-icon>calendar_today</mat-icon> {{ program.startDate }} - {{ program.endDate }}</span>
    <span
      ><mat-icon>assignment</mat-icon> GÃ¼nde {{ program.questionsPerDay }} soru, {{ program.subjectsPerDay }} konu</span
    >
    <span><mat-icon>timeline</mat-icon> TÃ¼r: {{ program.studyType }}</span>
  </div>

  <!-- Ã–zet Kartlar -->
  <div class="summary-cards">
    <mat-card class="summary-card">
      <mat-icon>assignment</mat-icon>
      <div>
        <div class="summary-value">{{ totalSolved }}</div>
        <div class="summary-label">Toplam Soru</div>
      </div>
    </mat-card>
    <mat-card class="summary-card">
      <mat-icon>timer</mat-icon>
      <div>
        <div class="summary-value">{{ totalMinutes }}</div>
        <div class="summary-label">Toplam SÃ¼re (dk)</div>
      </div>
    </mat-card>
    <mat-card class="summary-card">
      <mat-icon>percent</mat-icon>
      <div>
        <div class="summary-value">{{ successRate }}%</div>
        <div class="summary-label">BaÅŸarÄ± OranÄ±</div>
      </div>
    </mat-card>
  </div>

  <!-- Performans Radar GrafiÄŸi (Radar Chart) -->
  <div class="dashboard-section">
    <h3>Performans Radar GrafiÄŸi</h3>
    <ngx-charts-polar-chart
      [view]="[350, 250]"
      [scheme]="heatmapScheme"
      [results]="radarChartData"
      [legend]="true"
      [animations]="true"
      [showXAxisLabel]="true"
      [showYAxisLabel]="true"
      [xAxisLabel]="'Dersler'"
      [yAxisLabel]="'BaÅŸarÄ± (%)'"
    ></ngx-charts-polar-chart>
    <div class="radar-legend">
      <div>ğŸ“Œ Matematik: 85%</div>
      <div>ğŸ“Œ TÃ¼rkÃ§e: 60%</div>
      <div>ğŸ“Œ Fen: 40%</div>
      <div>ğŸ“Œ Sosyal Bil.: 75%</div>
      <div>ğŸ“Œ Ä°ngilizce: 90%</div>
    </div>
  </div>

  <!-- Trafik IÅŸÄ±klarÄ± Sistemi -->
  <div class="dashboard-section">
    <h3>Trafik IÅŸÄ±klarÄ± Sistemi</h3>
    <div class="traffic-row">
      <span class="traffic-green">ğŸŸ¢ Matematik hedefi: Ã‡ok iyi!</span><br />
      <span class="traffic-yellow">ğŸŸ¡ Fen hedefi: Orta dÃ¼zey.</span><br />
      <span class="traffic-red">ğŸ”´ Ä°ngilizce hedefi: Dikkat, zayÄ±f ilerleme!</span>
    </div>
  </div>

  <!-- Dairesel Ä°lerleme YÃ¼zdeleri (Circular Progress) -->
  <div class="dashboard-section">
    <h3>Dairesel Ä°lerleme YÃ¼zdeleri</h3>
    <div class="circular-progress-row">
      <div class="circular-progress">
        <mat-progress-spinner mode="determinate" [value]="75" diameter="60" color="primary"></mat-progress-spinner>
        <div>Matematik %75</div>
      </div>
      <div class="circular-progress">
        <mat-progress-spinner mode="determinate" [value]="45" diameter="60" color="accent"></mat-progress-spinner>
        <div>Fen %45</div>
      </div>
    </div>
  </div>

  <!-- KiÅŸisel SWOT Analizi -->
  <div class="dashboard-section">
    <h3>KiÅŸisel SWOT Analizi</h3>
    <div class="swot-grid">
      <div class="swot-block strength">
        <div class="swot-title"><mat-icon>trending_up</mat-icon> GÃ¼Ã§lÃ¼ YÃ¶nler</div>
        <ul>
          <li>Matematik</li>
          <li>DÃ¼zenlilik</li>
        </ul>
      </div>
      <div class="swot-block weakness">
        <div class="swot-title"><mat-icon>trending_down</mat-icon> GeliÅŸmesi Gerekenler</div>
        <ul>
          <li>Ä°ngilizce</li>
          <li>Fen Bilimleri</li>
        </ul>
      </div>
      <div class="swot-block opportunity">
        <div class="swot-title"><mat-icon>lightbulb</mat-icon> FÄ±rsatlar</div>
        <ul>
          <li>GÃ¼nlÃ¼k Ã§alÄ±ÅŸma sÃ¼reni artÄ±rabilirsin</li>
        </ul>
      </div>
      <div class="swot-block threat">
        <div class="swot-title"><mat-icon>warning</mat-icon> Riskler</div>
        <ul>
          <li>Ä°ngilizce hedeflerini sÃ¼rekli erteliyorsun</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- KadranlÄ± Hedef Metreleri (Gauge Chart) -->
  <div class="dashboard-section">
    <h3>KadranlÄ± Hedef Metreleri</h3>
    <div class="gauge-row">
      <div class="gauge-item">
        <span class="gauge-label">Matematik ğŸ“—</span>
        <div class="gauge-bar">
          <div class="gauge-bar-fill" style="width: 80%"></div>
          <span class="gauge-bar-text">80%</span>
        </div>
      </div>
      <div class="gauge-item">
        <span class="gauge-label">Fen Bil. ğŸ“˜</span>
        <div class="gauge-bar">
          <div class="gauge-bar-fill" style="width: 40%"></div>
          <span class="gauge-bar-text">40%</span>
        </div>
      </div>
      <div class="gauge-item">
        <span class="gauge-label">TÃ¼rkÃ§e ğŸ“•</span>
        <div class="gauge-bar">
          <div class="gauge-bar-fill" style="width: 70%"></div>
          <span class="gauge-bar-text">70%</span>
        </div>
      </div>
    </div>
  </div>

  <!-- KiÅŸisel BaÅŸarÄ± HaritasÄ± (Achievement Map) -->
  <div class="dashboard-section">
    <h3>KiÅŸisel BaÅŸarÄ± HaritasÄ±</h3>
    <div class="achievement-map">ğŸ BaÅŸlangÄ±Ã§ â†’ âœ… Ä°stasyon 1 â†’ âœ… Ä°stasyon 2 â†’ âŒ Ä°stasyon 3 â†’ ğŸ¯ Hedef</div>
  </div>

  <!-- GÃ¼nlÃ¼k Detay Carousel -->
  <div class="day-carousel-modern">
    <button (click)="scrollDays(-1)" [disabled]="carouselIndex === 0"><mat-icon>chevron_left</mat-icon></button>
    <div class="carousel-days-list">
      <div
        *ngFor="let day of visibleDays; let i = index"
        [class.selected]="selectedDay === day"
        (click)="selectDay(day)"
      >
        <div class="day-number">{{ getRealIndex(i) + 1 }}. GÃ¼n</div>
        <div class="day-status" [class.done]="day.done" [class.missed]="!day.done">
          <mat-icon>{{ day.done ? 'check_circle' : 'cancel' }}</mat-icon>
        </div>
        <div class="day-solved">{{ day.solved }} / {{ program.questionsPerDay }} soru</div>
      </div>
    </div>
    <button (click)="scrollDays(1)" [disabled]="carouselIndex >= maxCarouselIndex">
      <mat-icon>chevron_right</mat-icon>
    </button>
  </div>

  <!-- GÃ¼nlÃ¼k Detayda: Motivasyon, Emoji, Not, ProgressBar -->
  <div class="selected-day-detail" *ngIf="selectedDay">
    <h4>
      {{ selectedDay.date }} |
      <span [class.done]="selectedDay.done" [class.missed]="!selectedDay.done">{{
        selectedDay.done ? 'Hedefe UYULDU' : 'UYULMADI'
      }}</span>
    </h4>
    <div class="detail-row">
      <mat-icon>assignment</mat-icon> <b>{{ selectedDay.solved }}</b> soru
    </div>
    <div class="detail-row">
      <mat-icon>timer</mat-icon> <b>{{ selectedDay.minutes }}</b> dakika
    </div>
    <div class="detail-row">
      <mat-icon>mood</mat-icon> <span class="emoji">{{ selectedDay.mood }}</span>
    </div>
    <div class="detail-row">
      <mat-progress-bar
        mode="determinate"
        [value]="(selectedDay.solved / program.questionsPerDay) * 100"
      ></mat-progress-bar>
      <span class="progress-label"
        >Hedef Tamamlanma: {{ (selectedDay.solved / program.questionsPerDay) * 100 | number : '1.0-0' }}%</span
      >
    </div>
    <div class="detail-row feedback-row">
      <mat-icon>emoji_objects</mat-icon>
      <span class="motivation">{{ getMotivation(selectedDay) }}</span>
    </div>
    <div class="detail-row" *ngIf="selectedDay.subjects.length">
      <mat-icon>menu_book</mat-icon>
      <span>Dersler:</span>
      <ul>
        <li *ngFor="let s of selectedDay.subjects">
          <b>{{ s.name }}</b
          >: {{ s.solved }} soru, {{ s.minutes }} dk
        </li>
      </ul>
    </div>
    <div class="detail-row" *ngIf="selectedDay.notes">
      <mat-icon>note</mat-icon>
      <span>{{ selectedDay.notes }}</span>
    </div>
    <div class="detail-row">
      <mat-form-field appearance="outline" class="note-input">
        <mat-label>BugÃ¼nkÃ¼ Notun</mat-label>
        <input matInput [(ngModel)]="selectedDay.notes" placeholder="KÄ±sa bir not ekle..." />
      </mat-form-field>
    </div>
  </div>

  <!-- Ekstra: Streak, En Ä°yi GÃ¼n, En KÃ¶tÃ¼ GÃ¼n, Pie Chart, Not/Emoji, ProgressBar -->
  <div class="extra-stats-row">
    <mat-card class="extra-card streak">
      <mat-icon>whatshot</mat-icon>
      <div>
        <div class="extra-value">{{ currentStreak }}</div>
        <div class="extra-label">GÃ¼nlÃ¼k Streak</div>
      </div>
    </mat-card>
    <mat-card class="extra-card streak-max">
      <mat-icon>local_fire_department</mat-icon>
      <div>
        <div class="extra-value">{{ maxStreak }}</div>
        <div class="extra-label">En Uzun Streak</div>
      </div>
    </mat-card>
    <mat-card class="extra-card best" *ngIf="bestDay">
      <mat-icon>star</mat-icon>
      <div>
        <div class="extra-value">{{ bestDay.solved }}</div>
        <div class="extra-label">En Ä°yi GÃ¼n ({{ bestDay.date }})</div>
      </div>
    </mat-card>
    <mat-card class="extra-card worst" *ngIf="worstDay">
      <mat-icon>sentiment_dissatisfied</mat-icon>
      <div>
        <div class="extra-value">{{ worstDay.solved }}</div>
        <div class="extra-label">En KÃ¶tÃ¼ GÃ¼n ({{ worstDay.date }})</div>
      </div>
    </mat-card>
  </div>

  <!-- Yeni Dashboard BÃ¶lÃ¼mÃ¼ -->
  <div class="dashboard-section">
    <h3>ğŸ“Š GÃ¼nlÃ¼k Uyum OranÄ± (Son 7 GÃ¼n)</h3>
    <div class="course-progress-row">
      <div *ngFor="let day of program.days.slice(-7)" class="subject-progress">
        <span>{{ day.date | date : 'd MMM' }}</span>
        <mat-progress-bar mode="determinate" [value]="(day.solved / program.questionsPerDay) * 100"></mat-progress-bar>
        <span>{{ (day.solved / program.questionsPerDay) * 100 | number : '1.0-0' }}%</span>
      </div>
    </div>

    <h3>ğŸ“ˆ Soru Hedefi Tamamlama GrafiÄŸi (Son 7 GÃ¼n)</h3>
    <!-- <ngx-charts-bar-vertical
      [view]="[420, 160]"
      [scheme]="heatmapScheme"
      [results]="barChartData.slice(-7)"
      [xAxis]="true"
      [yAxis]="true"
      [legend]="false"
      [showXAxisLabel]="false"
      [showYAxisLabel]="false"
      [roundEdges]="true"
      [animations]="true"
    ></ngx-charts-bar-vertical> -->

    <h3>ğŸ“… Ã‡alÄ±ÅŸÄ±lan/Ã‡alÄ±ÅŸÄ±lmayan GÃ¼n Takvimi (Son 14 GÃ¼n)</h3>
    <div class="course-progress-row">
      <div
        *ngFor="let day of program.days.slice(-14)"
        [ngClass]="{
          'subject-progress': true,
          done: day.done,
          missed: !day.done && day.solved === 0,
          partial: !day.done && day.solved > 0
        }"
      >
        <mat-icon *ngIf="day.done">check_circle</mat-icon>
        <mat-icon *ngIf="!day.done && day.solved === 0">cancel</mat-icon>
        <mat-icon *ngIf="!day.done && day.solved > 0">hourglass_bottom</mat-icon>
        <span>{{ day.date | date : 'd MMM' }}</span>
      </div>
    </div>

    <div class="streak-badge">
      <mat-icon>local_fire_department</mat-icon>
      ğŸ”¥ {{ currentStreak }} GÃ¼nlÃ¼k Seri!
    </div>

    <div class="record-badges">
      <div class="record-badge">
        <mat-icon>star</mat-icon> En fazla soru: {{ bestDay?.solved }} ({{ bestDay?.date }})
      </div>
      <div class="record-badge">
        <mat-icon>timer</mat-icon> En uzun sÃ¼re: {{ maxMinutesDay?.minutes }} dk ({{ maxMinutesDay?.date }})
      </div>
      <div class="record-badge">
        <mat-icon>percent</mat-icon> En yÃ¼ksek uyum: {{ maxRateDay?.rate }}% ({{ maxRateDay?.date }})
      </div>
    </div>

    <div class="achievement-badges">
      <div class="achievement-badge"><mat-icon>emoji_events</mat-icon> Ä°lk 100 Soru Ã‡Ã¶zÃ¼ldÃ¼!</div>
      <div class="achievement-badge"><mat-icon>emoji_events</mat-icon> Ä°lk 5 GÃ¼n Ãœst Ãœste TamamlandÄ±</div>
      <div class="achievement-badge"><mat-icon>emoji_events</mat-icon> Toplam 1000 Soru!</div>
    </div>

    <div class="weekly-summary">
      HaftalÄ±k toplam soru: {{ weeklyTotalSolved }} | HaftalÄ±k toplam sÃ¼re: {{ weeklyTotalMinutes }} dk
    </div>

    <div class="subject-progress-row">
      <div *ngFor="let s of subjectStats" class="subject-progress">
        <mat-icon>menu_book</mat-icon> {{ s.name }}: {{ s.solved }} soru, {{ s.minutes }} dk
      </div>
    </div>

    <div class="comparison-section">
      Senin gibi 8. sÄ±nÄ±f Ã¶ÄŸrencileri haftada ortalama 150 soru Ã§Ã¶zÃ¼yor. Sen {{ weeklyTotalSolved }} soru Ã§Ã¶zdÃ¼n,
      harikasÄ±n!
    </div>

    <div class="suggestion-section">
      Son 3 gÃ¼ndÃ¼r Matematik hedefini kaÃ§Ä±rÄ±yorsun, bugÃ¼n hedefe ulaÅŸmak iÃ§in Ã¶nerilen sÃ¼re 45 dk.
    </div>

    <!-- Duolingo Stili Seri UyarÄ±sÄ± -->
    <div class="streak-warning" *ngIf="currentStreak > 0 && currentStreak < maxStreak">
      <mat-icon>local_fire_department</mat-icon>
      ğŸ”¥ {{ currentStreak }} gÃ¼n seri! Seri kÄ±rÄ±lmamasÄ± iÃ§in bugÃ¼n {{ program.questionsPerDay }} soru Ã§Ã¶zmelisin!
    </div>

    <!-- Google Classroom Stili GÃ¶rev Takvimi -->
    <div class="task-calendar">
      <div class="task-row completed">Matematik: TamamlandÄ± âœ… (4/5 gÃ¶rev), GeÃ§ teslim â— (1 gÃ¶rev)</div>
      <div class="task-row missing">Fen Bilimleri: Eksik âŒ (0/3 gÃ¶rev)</div>
    </div>

    <!-- Khan Academy TarzÄ± Beceri AÄŸacÄ± -->
    <div class="skill-tree">
      <div class="skill-branch">
        Matematik â†’ Kesirler
        <mat-progress-bar class="skill-progress" mode="determinate" [value]="80"></mat-progress-bar>
        %80 tamamlandÄ±
      </div>
      <div class="skill-branch locked">
        Matematik â†’ Kesirler â†’ Ä°leri Seviye Sorular
        <mat-icon>lock</mat-icon> (Kilidi aÃ§mak iÃ§in %90 tamamlanmalÄ±!)
      </div>
    </div>

    <!-- Quizlet TarzÄ± EtkileÅŸimli Ä°statistikler -->
    <div class="study-stats-row">
      <div class="study-stat"><mat-icon>schedule</mat-icon> En verimli saat: 18:00 - 19:00</div>
      <div class="study-stat"><mat-icon>check_circle</mat-icon> DoÄŸru cevap oranÄ±: %92</div>
    </div>

    <!-- Notion Akademik Dashboard Odak Konular -->
    <div class="focus-topics">
      Bu hafta odaklandÄ±ÄŸÄ±n konular:<br />
      Matematik â€“ Trigonometri (%60 tamamlandÄ±)<br />
      Tarih â€“ I. DÃ¼nya SavaÅŸÄ± (%100 tamamlandÄ±)
    </div>

    <!-- Forest UygulamasÄ± TarzÄ± Zaman YÃ¶netimi -->
    <div class="forest-row">
      <span>Bu hafta 5 kez 45 dakika kesintisiz Ã§alÄ±ÅŸtÄ±n ve 5 aÄŸaÃ§ diktin</span>
      <span class="forest-tree">ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³</span>
    </div>

    <!-- Udemy TarzÄ± Ä°lerleme BarlarÄ± -->
    <div class="course-progress-row">
      <div class="course-progress">
        Biyoloji: %45 tamamlandÄ±, hedef %60 ğŸ“Œ (geride kalÄ±yorsun, hÄ±zlanmalÄ±sÄ±n!)
        <mat-progress-bar class="skill-progress" mode="determinate" [value]="45"></mat-progress-bar>
      </div>
    </div>

    <!-- Trello TarzÄ± Kart YapÄ±larÄ± -->
    <div class="trello-board">
      <div class="trello-list">
        <div class="trello-list-title">âœ… Tamamlanan</div>
        <div class="trello-card completed">Matematik (Ã‡arpanlara ayÄ±rma)</div>
      </div>
      <div class="trello-list">
        <div class="trello-list-title">â³ Devam eden</div>
        <div class="trello-card inprogress">TÃ¼rkÃ§e (Dil Bilgisi â€“ SÄ±fatlar)</div>
      </div>
      <div class="trello-list">
        <div class="trello-list-title">ğŸ“… Planlanan</div>
        <div class="trello-card planned">Fizik (Optik) â€“ yarÄ±n baÅŸlanacak</div>
      </div>
      <div class="trello-list">
        <div class="trello-list-title">ğŸš© Ertelenen</div>
        <div class="trello-card delayed">Kimya (Asitler ve Bazlar)</div>
      </div>
    </div>
  </div>

  <!-- GÃ¼nlÃ¼k Performans IsÄ± HaritasÄ± (Modern) -->
  <div class="dashboard-section">
    <h3>GÃ¼nlÃ¼k Performans IsÄ± HaritasÄ± 2</h3>

    <div class="heatmap-grid">
      <div
        *ngFor="let day of program.days; let i = index"
        class="heatmap-cell"
        [ngClass]="{
          'heatmap-green': day.done,
          'heatmap-yellow': !day.done && day.solved > 0,
          'heatmap-red': !day.done && day.solved === 0
        }"
        [matTooltip]="day.date + ': ' + (day.done ? 'TamamlandÄ±' : day.solved > 0 ? 'KÄ±smen' : 'Ã‡alÄ±ÅŸÄ±lmadÄ±')"
      ></div>
    </div>
  </div>
</div>
