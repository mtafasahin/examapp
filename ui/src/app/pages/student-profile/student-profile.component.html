@if(student) 
{
 
   <!-- Avatar Component (avatar.component.html) -->


  <mat-tab-group [(selectedIndex)]="activeTab">
    <mat-tab label="Info">
       
      <mat-card class="profile-card">
        <mat-card-header>
          <div class="profile-header stats-container">
            <div class="avatar-container">
              <img [src]="student.avatarUrl || 'default-avatar.png'" class="avatar" />
              <div class="avatar-overlay" (click)="avatarInput.click()">
                <span>Change</span>
              </div>
              <input type="file" #avatarInput (change)="onAvatarChange($event)" hidden />
            </div>
            <div class="stat">
              <h2>{{ student.fullName }}</h2>        
            </div>
            
            <div class="stat">
              <mat-select [(value)]="student.gradeId" (selectionChange)="changeGrade()">
                  @for ( grade of grades ; track grade.id ) 
                  {
                    <mat-option [value]="grade.id">{{ grade.name }}</mat-option>
                  }
                </mat-select>
            </div>
            <div class="stat"><p>Seviye: {{ student.level }} ({{ student.xp }} XP)</p></div>
            
          </div>
        </mat-card-header>
          <mat-card-content >
            
            <div class="stats-container">
              <div class="stat">
                <mat-icon>question_answer</mat-icon>
                <span>{{ student.totalQuestionsSolved }} Soru Ã‡Ã¶zÃ¼ldÃ¼</span>
              </div>
              <div class="stat">
                <mat-icon>check_circle</mat-icon>
                <span>{{ student.correctAnswers }} DoÄŸru Cevap</span>
              </div>
              <div class="stat">
                <mat-icon>highlight_off</mat-icon>
                <span>{{ student.wrongAnswers }} YanlÄ±ÅŸ Cevap</span>
              </div>
              <div class="stat">
                <mat-icon>assignment_turned_in</mat-icon>
                <span>{{ student.testsCompleted }} Tamamlanan Test</span>
              </div>
              <div class="stat">
                <mat-icon>emoji_events</mat-icon>
                <span>{{ student.totalRewards }} KazanÄ±lan Ã–dÃ¼l</span>
              </div>
              <div class="stat">
                <mat-icon>leaderboard</mat-icon>
                <span>Liderlik SÄ±ralamasÄ±: {{ student.leaderboardRank || '-' }}</span>
              </div>
            </div>
      
            <h3>ðŸŽ– KazanÄ±lan Rozetler</h3>
            <div class="badges-container">
              @for ( badge of student.badges ; track badge.name ) 
              {
                <img [src]="badge.imageUrl" [matTooltip]="badge.name" class="badge" />
              }
            </div>
      
            <!-- <h3>ðŸ“Œ Son Ã‡Ã¶zÃ¼len Testler</h3>
            <mat-list>
              @for (test of student.recentTests ; track test.name) 
              {
                <mat-list-item>
                  <span>{{ test.name }}</span>
                  <span class="test-score">{{ test.score }}/{{ test.totalQuestions * 10 }} Puan</span>
                </mat-list-item>
              }
             
            </mat-list> -->
          </mat-card-content>
        </mat-card>
    </mat-tab>
    <mat-tab label="Badges">
        <div class="points-container">
          <app-point-card title="My Points" value="2,500" icon="whatshot"></app-point-card>
          <app-point-card title="Class Rank" value="3rd" icon="terrain"></app-point-card>
          <app-point-card title="Year 12 Rank" value="128" icon="flag"></app-point-card>
        </div>
        <app-section-header title="My Badges" icon="assets/icons/badge.png"></app-section-header>
      
        <div class="badges-container">
          <app-badge-box 
            *ngFor="let badge of badges" 
            [badgeTitle]="badge.title"
            [badgeLevel]="badge.level"
            [badgeIcon]="badge.icon">
          </app-badge-box>
        </div>
      
        <app-section-header title="Leaderboards" icon="assets/icons/leaderboard.png"></app-section-header>
      
      
        <div class="leaderboards-container">
          <app-leaderboard 
            leaderboardTitle="Class Leaderboard"
            [leaderboardData]="classLeaderboard">
          </app-leaderboard>
        
          <app-leaderboard 
            leaderboardTitle="Group Level Leaderboard"
            [leaderboardData]="groupLeaderboard"
            [showDetails]="true">
          </app-leaderboard>
        </div>
    </mat-tab>
     <!-- Info Tab (Gelecekte KullanÄ±labilir) -->
  

  <!-- Assignments and Exams Tab -->
  <mat-tab label="Assignments and Exams">
    <!-- <canvas
    baseChart
    [data]="bubbleChartData"
    [options]="bubbleChartOptions2"
    [legend]="true"
    [type]="bubbleChartType"    
    (chartClick)="chartClicked($event)"
  >
  </canvas> -->


  <div class="bubble-chart-container">
    <!-- <ngx-charts-bubble-chart
  [view]="[700, 200]"
  [scheme]="colorScheme"
  [results]="bubbleData"
  [xAxis]="showXAxis"
  [yAxis]="showYAxis"
  [legend]="showLegend"
  [showXAxisLabel]="showXAxisLabel"
  [showYAxisLabel]="showYAxisLabel"
  [xAxisLabel]="xAxisLabel"
  [yAxisLabel]="yAxisLabel"
  [xScaleMin]="yScaleMin"
  [xScaleMax]="yScaleMax"
  [yScaleMin]="yScaleMin"
  [yScaleMax]="yScaleMax"
  [minRadius]="minRadius"
  [maxRadius]="maxRadius">
</ngx-charts-bubble-chart> -->

<app-bubble-chart></app-bubble-chart>

  </div>

  <div class="number-card-container">
  <ngx-charts-number-card
  [view]="[700, 200]"
  [scheme]="colorScheme2"
  [results]="single"
  [cardColor]="cardColor"
  (select)="onSelect($event)">
</ngx-charts-number-card>
  </div>


  <div class="goal-container">
    <div class="goal-header">
      <h2>Weekly Goal</h2>
      <mat-icon>visibility</mat-icon>
    </div>    
    <mat-tab-group [(selectedIndex)]="activeTab2">
      <mat-tab label="Monthly">
        <div class="goal-stats">0 weeks</div>
          <p class="goal-subtext">Longest weekly goal streak</p>
          <div class="goal-divider"></div>
          <h4>March 2025</h4>
          <p class="goal-subtext">No activity</p>
      </mat-tab>
      <mat-tab label="Current">
      </mat-tab>
    </mat-tab-group>
    
  </div>

  </mat-tab>

  <!-- Weekly Calendar Tab -->
  <mat-tab label="Weekly Calendar">
    <div class="heatmap-container">
      <h2>Activity Heatmap</h2>
      <ngx-charts-heat-map
        [view]="[1200, 210]"
        [scheme]="colorScheme"
        [results]="activityData"
        [xAxis]="true"
        [yAxis]="true"
        [legend]="false"
        [showXAxisLabel]="true"
        [showYAxisLabel]="true"
        [gradient]="true"
        [xAxisTickFormatting]="xAxisTickFormatting">
      </ngx-charts-heat-map>
    
      
    </div>
    
    
  </mat-tab>
  </mat-tab-group>

  
  
  



}