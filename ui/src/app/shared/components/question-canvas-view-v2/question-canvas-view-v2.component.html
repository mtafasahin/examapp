<div class="canvas-container" [ngClass]="_questionRegion().layoutPlan?.layoutClass" [ngStyle]="getContainerStyle()">
  @if(isImageLoaded()) {
  <div class="question-panel" [style.flex]="getPanelFlex('question')">
    @if(hasPassageImage()) {
    <div class="image-slice passage-image" [ngStyle]="getPassageWrapperStyle()">
      <img
        class="passage-image-element"
        [src]="passageImageSource()"
        [ngStyle]="getPassageImageStyle()"
        alt="Passaj görseli"
      />
    </div>
    }

    <div class="image-slice question-image-slice" [ngStyle]="getQuestionWrapperStyle()">
      <img
        class="question-image"
        [src]="questionImageSource()"
        [ngStyle]="getQuestionImageStyle()"
        alt="Soru görseli"
      />
    </div>
  </div>

  @if(_questionRegion().answers.length) {
  <div class="answers-panel" [ngStyle]="getAnswersPanelStyle()" [style.flex]="getPanelFlex('answers')">
    @for (answer of _questionRegion().answers; track idx; let idx = $index) {
    <div
      class="answer-wrapper image-slice"
      [ngStyle]="getAnswerWrapperStyle(answer)"
      (mouseenter)="hoverAnswer(answer)"
      (mouseleave)="hoverAnswer(null)"
      (click)="selectAnswer(idx)"
      [ngClass]="getAnswerClasses(answer)"
      [attr.aria-label]="'Şık ' + (idx + 1)"
    >
      <img
        class="answer-image"
        [src]="answer.imageUrl"
        [ngStyle]="getAnswerImageStyle(answer)"
        [attr.alt]="'Şık ' + (idx + 1)"
      />
    </div>
    }
  </div>
  } } @else {
  <div class="image-loading">Görsel yükleniyor…</div>
  }
</div>

@if(isPreviewMode) {
<div class="preview-actions" style="margin-top: 10px; display: flex; gap: 10px; justify-content: center">
  <button mat-raised-button color="warn" (click)="removeQuestion()">
    <mat-icon>delete</mat-icon>
    Soruyu Testten Çıkar
  </button>
  <button mat-raised-button (click)="shrinkImage()" aria-label="Küçült (-5%)">
    <mat-icon>zoom_out</mat-icon>
    Küçült (-5%)
  </button>
  <button mat-raised-button (click)="enlargeImage()" aria-label="Büyüt (+5%)">
    <mat-icon>zoom_in</mat-icon>
    Büyüt (+5%)
  </button>
</div>
}

<div>
  @if(_questionRegion() && _questionRegion().isExample) { @if(correctAnswerVisible) {
  <div class="correct-answer">
    Doğru Cevap:
    <div class="question-lite-text" [innerHTML]="_questionRegion().exampleAnswer | safeHtml"></div>
  </div>
  }
  <button mat-button (click)="showCorrectAnswer()">Sonucu Gör</button>
  }
</div>
