<div class="classification-selector">
  <!-- Grade Selection -->
  <div class="classification-level">
    <h4 class="level-title">Sınıf</h4>
    <div class="chips-container">
      <mat-chip-listbox [value]="selectedGrade()">
        @for (grade of grades(); track grade.id) {
          <mat-chip-option [value]="grade.id" (click)="selectGrade(grade.id)">
            {{ grade.name }}
          </mat-chip-option>
        }
      </mat-chip-listbox>
    </div>
  </div>

  <!-- Subject Selection -->
  @if (selectedGrade() && subjects().length > 0) {
    <div class="classification-level">
      <h4 class="level-title">Ders</h4>
      <div class="chips-container">
        <mat-chip-listbox [value]="selectedSubject()">
          @for (subject of subjects(); track subject.id) {
            <mat-chip-option [value]="subject.id" (click)="selectSubject(subject.id)">
              {{ subject.name }}
            </mat-chip-option>
          }
        </mat-chip-listbox>
      </div>
    </div>
  }

  <!-- Topic Selection -->
  @if (selectedSubject() && topics().length > 0) {
    <div class="classification-level">
      <h4 class="level-title">Konu</h4>
      <div class="chips-container">
        <mat-chip-listbox [value]="selectedTopic()">
          @for (topic of topics(); track topic.id) {
            <mat-chip-option [value]="topic.id" (click)="selectTopic(topic.id)">
              {{ topic.name }}
            </mat-chip-option>
          }
        </mat-chip-listbox>
      </div>
    </div>
  }

  <!-- Subtopic Selection (Multiple) -->
  @if (selectedTopic() && subtopics().length > 0) {
    <div class="classification-level">
      <h4 class="level-title">Alt Konular (Çoklu Seçim)</h4>
      <div class="chips-container">
        <mat-chip-listbox multiple>
          @for (subtopic of subtopics(); track subtopic.id) {
            <mat-chip-option [selected]="isSubtopicSelected(subtopic.id)" (click)="toggleSubtopic(subtopic.id)">
              {{ subtopic.name }}
            </mat-chip-option>
          }
        </mat-chip-listbox>
      </div>
    </div>
  }

  @if (showApplyButton) {
    <!-- Apply Button -->
    <div class="apply-actions">
      <button mat-raised-button color="primary" [disabled]="!canApply()" (click)="onApply()">
        <mat-icon>check</mat-icon>
        Uygula
      </button>
    </div>
  }
</div>
